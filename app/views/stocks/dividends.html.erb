<div class="container-fluid">
  <div class="row">
      <nav class="col-md-2 d-none d-md-block bg-light sidebar">
        <div class="sidebar-sticky">
          <ul class="nav flex-column">
            <li class="nav-item">
              <a class="nav-link" href="<%= portfolios_path %>">
                <span data-feather="home"></span>
                Portfolios <span class="sr-only">(current)</span>
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="<%= stocks_path %>">
                <span data-feather="file"></span>
                Stocks 
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="<%= home_path %>">
                <span data-feather="file"></span>
                Graph 
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link active" href="<%= dividends_path %>">
                <span data-feather="file"></span>
                Dividends 
              </a>
            </li>
          <li class="nav-item">
            <a class="nav-link" href="<%= histories_path %>">
              <span data-feather="home"></span>
              Utilities 
            </a>
          </li>
          </ul>

        <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
          <span>Saved reports</span>
          <a class="d-flex align-items-center text-muted" href="#">
            <span data-feather="plus-circle"></span>
          </a>
        </h6>
        <ul class="nav flex-column mb-2">
          <li class="nav-item">
            <a class="nav-link" href="#">
              <span data-feather="file-text"></span>
              Current month
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">
              <span data-feather="file-text"></span>
              Last quarter
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">
              <span data-feather="file-text"></span>
              Social engagement
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">
              <span data-feather="file-text"></span>
              Year-end sale
            </a>
          </li>
        </ul>
      </div>
    </nav>

    <main role="main" class="col-md-9 ml-sm-auto col-lg-10 pt-3 px-4">


   <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pb-2 mb-3 border-bottom">
     <h1 id='portfolio_name' class="h2">Stock Dividends</h1>
	     <div class="btn-toolbar mb-2 mb-md-0">	
	     </div>
   </div>

  <div class="table-responsive">
	<table class="table table-bordered table-striped table-sm">
	  <thead>
	    <tr>
	      	<th>Symbol</th>
			<th class='text-right'>Shares</th>
	      	<th class='text-right'>Investment</th>
			<th class='text-right'>Annual_Divs</th>			
			<th class='text-right'>Yield</th>			
			<% (0..11).each do |i| %>
		      <th class='text-right'><%= "#{Date::ABBR_MONTHNAMES[@dates[i][1]]}-#{@dates[i][0].to_s[2..3]}" %></th>
			<% end %>
	    </tr>
	  </thead>

  <tbody>
			    
    <% @stock_divs.each do |sym| %>
      <tr>
	    <td><%= sym[0] %></td>
	    <td class='text-right'><%= number_with_precision(sym[2], precision: 2) %></td>
	    <td class='text-right'><%= number_to_currency(sym[3] * Stock.find_by_symbol(sym[0]).price) %></td>
	    <td class='text-right'><%= number_to_currency(sym[3]) %></td>
				<% y = sym[3] > 0 ? 100 * ( sym[3] / (sym[3] * Stock.find_by_symbol(sym[0]).price) ) : 0 %>
	    <td class='text-right'><%= number_to_percentage( y ) %></td>
		<% (0..11).each do |date| %>
		<% month = @dates[date][1] %>
			<% if sym[1].select { |d| d[1] == month }.empty? %>
				<% val = '' %>
			<% else %>
			<% val = number_to_currency(sym[1].select { |d| d[1] == month }.sum(0) { |t| t[2].to_f * sym[2].to_f }) %>
			<% end %>
        <td class='text-right'><%=  val %></td>
		<% end %>
	 </tr>
    <% end %>

	<tr>
		<td></td>
		<td></td>
		<td></td>
		<td class='text-right'><%= number_to_currency(@monthly_stock_divs_total) %></td>
		<td></td>
		
		<% ['05','04','03','02','01','12','11','10','09','08','07','06'].each do |month| %>
		    <td class='text-right'><%= number_to_currency(@annual_stock_divs_total[month]) %></td>
		<% end %>
	</tr>
  </tbody>
</table>



   <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pb-2 mb-3 border-bottom">
     <h1 id='portfolio_name' class="h2">Fund Dividends</h1>
	     <div class="btn-toolbar mb-2 mb-md-0">	
	     </div>
   </div>

  <div class="table-responsive">
	<table class="table table-bordered table-striped table-sm">
	  <thead>
	    <tr>
	      	<th>Symbol</th>
	      	<th>Total</th>
			<% (0..11).each do |i| %>
		      <th class='text-right'><%= "#{Date::ABBR_MONTHNAMES[@dates[i][1]]}-#{@dates[i][0].to_s[2..3]}" %></th>
			<% end %>
	    </tr>
	  </thead>

  <tbody>

    <% @fund_divs.each do |sym| %>
      <tr>
	    <td><%= sym[0] %></td>
	    <td class='text-right'><%= number_to_currency(sym[3]) %></td>
		<% (0..11).each do |date| %>
		<% month = @dates[date][1] %>
			<% if sym[1].select { |d| d[1] == month }.empty? %>
				<% val = '' %>
			<% else %>
			<% val = number_to_currency(sym[1].select { |d| d[1] == month }.sum(0) { |t| t[2].to_f * sym[2].to_f }) %>
			<% end %>
        <td class='text-right'><%=  val %></td>
		<% end %>
	 </tr>
    <% end %>

	<tr>
		<td></td>
		<td class='text-right'><%= number_to_currency(@monthly_fund_divs_total) %></td>
		<% ['05','04','03','02','01','12','11','10','09','08','07','06'].each do |month| %>
		    <td class='text-right'><%= number_to_currency(@annual_fund_divs_total[month]) %></td>
		<% end %>
	</tr>
  </tbody>
</table>

    </main>
  </div>
</div>

<script>
$(document).ready(function() {
  feather.replace() ;	
 });
</script>
